# Мониторинг обработки

После начала обработки Chloros предоставляет несколько способов отслеживания прогресса, проверки наличия проблем и понимания того, что происходит с вашим набором данных. На этой странице объясняется, как отслеживать обработку и интерпретировать информацию, предоставляемую Chloros.

## Обзор индикатора прогресса

Индикатор прогресса в верхнем заголовке отображает статус обработки в режиме реального времени и процент завершения.

### Индикатор прогресса в бесплатном режиме

Для пользователей без лицензии Chloros+:

**Отображение прогресса в 2 этапа:**

1. **Обнаружение целей** — поиск калибровочных целей на изображениях.
2. **Обработка** — применение корректировок и экспорт.

**Индикатор выполнения показывает:**

* Общий процент выполнения (0-100%)
* Название текущего этапа
* Простая визуализация в виде горизонтальной полосы

### Индикатор выполнения Chloros+

Для пользователей с лицензией Chloros+:

**4-этапное отображение выполнения:**

1. **Обнаружение** — поиск целей калибровки
2. **Анализ** — изучение изображений и подготовка конвейера
3. **Калибровка** — применение корректировок виньетирования и отражения
4. **Экспорт** — сохранение обработанных файлов

**Интерактивные функции:**

* **Наведите курсор на** индикатор прогресса, чтобы увидеть расширенную 4-этапную панель
* **Щелкните** индикатор прогресса, чтобы зафиксировать/закрепить расширенную панель
* **Щелкните еще раз**, чтобы отменить фиксацию и автоматически скрыть панель при уходе курсора мыши
* Каждый этап отображает индивидуальный прогресс (0-100%)

***

## Понимание каждого этапа обработки

### Этап 1: Обнаружение (обнаружение целей)

**Что происходит:**

* Chloros сканирует изображения, отмеченные флажком «Цель»
* Алгоритмы компьютерного зрения идентифицируют 4 панели калибровки
* Из каждой панели извлекаются значения отражения
* Записываются временные метки целей для правильного планирования калибровки

**Продолжительность:**

* С отмеченными целями: 10–60 секунд
* Без отмеченных целей: 5–30+ минут (сканирует все изображения)

**Индикатор прогресса:**

* Обнаружение: 0% → 100%
* Количество отсканированных изображений
* Количество найденных целей

**На что следует обратить внимание:**

* Должно завершиться быстро, если цели правильно отмечены
* Если процесс занимает слишком много времени, цели могут быть не отмечены
* Проверьте журнал отладки на наличие сообщений «Цель найдена»

### Этап 2: Анализ

**Что происходит:**

* Чтение метаданных EXIF изображения (временные метки, настройки экспозиции)
* Определение стратегии калибровки на основе временных меток целей
* Организация очереди обработки изображений
* Подготовка рабочих процессов параллельной обработки (только Chloros+)

**Продолжительность:** 5-30 секунд

**Индикатор прогресса:**

* Анализ: 0% → 100%
* Быстрый этап, обычно завершается быстро

**На что следует обратить внимание:**

* Прогресс должен быть стабильным, без пауз
* Предупреждения об отсутствующих метаданных появятся в журнале отладки

### Этап 3: Калибровка

**Что происходит:**

* **Дебейринг**: преобразование RAW-матрицы Байера в 3 канала
* **Коррекция виньетирования**: удаление затемнения по краям объектива
* **Калибровка отражательной способности**: нормализация с помощью целевых значений
* **Расчет индекса**: вычисление мультиспектральных индексов
* Обработка каждого изображения по полному циклу

**Продолжительность:** большая часть общего времени обработки (60–80 %)

**Индикатор прогресса:**

* Калибровка: 0% → 100%
* Текущее обрабатываемое изображение
* Завершенные изображения / Общее количество изображений

**Поведение обработки:**

* **Свободный режим**: последовательная обработка одного изображения за раз
* **Режим Chloros+**: одновременная обработка до 16 изображений
* **Ускорение GPU**: значительно ускоряет этот этап

**На что следует обратить внимание:**

* Стабильный прогресс по количеству изображений
* Проверьте журнал отладки на наличие сообщений о завершении обработки каждого изображения
* Предупреждения о качестве изображения или проблемах с калибровкой

### Этап 4: Экспорт

**Что происходит:**

* Запись откалиброванных изображений на диск в выбранном формате
* Экспорт мультиспектральных индексных изображений с цветами LUT
* Создание подпапок для моделей камер
* Сохранение исходных имен файлов с соответствующими суффиксами

**Продолжительность:** 10–20 % от общего времени обработки

**Индикатор прогресса:**

* Экспорт: 0 % → 100 %
* Запись файлов
* Формат экспорта и место назначения

**На что следует обратить внимание:**

* Предупреждения о нехватке места на диске
* Ошибки записи файлов
* Завершение всех настроенных выводов

***

## Вкладка «Журнал отладки»

Журнал отладки содержит подробную информацию о ходе обработки и любых возникших проблемах.

### Доступ к журналу отладки

1. Нажмите значок **Журнал отладки** <img src="../.gitbook/assets/icon_log.JPG" alt="" data-size="line"> на левой боковой панели
2. Откроется панель журнала с сообщениями об обработке в режиме реального времени
3. Автоматическая прокрутка для отображения последних сообщений

### Понимание сообщений журнала

#### Информационные сообщения (белые/серые)

Обычные обновления обработки:

```
[INFO] Processing started
[INFO] Target detected in IMG_0015.RAW - 4 panels found
[INFO] Calibrating IMG_0234.RAW
[INFO] Exported NDVI image: IMG_0234_NDVI.tif
[INFO] Processing complete
```

#### Предупреждающие сообщения (желтые)

Некритические проблемы, которые не останавливают обработку:

```
[WARN] No GPS data found in IMG_0145.RAW
[WARN] Target image timestamp gap > 30 minutes
[WARN] Low contrast in calibration panel - results may vary
```

**Действие:** Просмотрите предупреждения после обработки, но не прерывайте ее.

#### Сообщения об ошибках (Red)

Критические проблемы, которые могут привести к сбою обработки:

```
[ERROR] Cannot write file - disk full
[ERROR] Corrupted image file: IMG_0299.RAW
[ERROR] No targets detected - enable reflectance calibration or mark target images
```

**Действие:** Остановить обработку, устранить ошибку, перезапустить.

### Общие сообщения журнала

| Сообщение                          | Значение                                | Необходимые действия                                         |
| -------------------------------- | -------------------------------------- | ----------------------------------------------------- |
| «Цель обнаружена в \[имя файла]» | Цель калибровки найдена успешно  | Нет — нормально                                         |
| «Обработка изображения X из Y»        | Обновление текущего прогресса                | Нет — нормально                                         |
| «Цели не найдены»               | Цели калибровки не обнаружены        | Пометить изображения целей или отключить калибровку отражения |
| «Недостаточно места на диске»        | Недостаточно места для вывода          | Освободите место на диске                                    |
| «Пропуск поврежденного файла»        | Файл изображения поврежден                  | Перекопируйте файл с SD-карты                             |
| «Применены данные PPK»               | Применены поправки GPS из файла .daq | Нет — нормально                                         |

### Копирование данных журнала

Чтобы скопировать журнал для устранения неполадок или поддержки:

1. Откройте панель «Журнал отладки».
2. Нажмите кнопку **«Копировать журнал»** (или щелкните правой кнопкой мыши → Выбрать все).
3. Вставьте в текстовый файл или электронное письмо.
4. При необходимости отправьте в службу поддержки MAPIR.

***

## Мониторинг системных ресурсов

### Использование ЦП

**Свободный режим:**

* 1 ядро ЦП на \~100%
* Другие ядра простаивают или доступны
* Система остается отзывчивой

**Chloros+ Параллельный режим:**

* Несколько ядер на 80-100% (до 16 ядер)
* Высокая общая загрузка ЦП
* Система может работать с меньшей отзывчивостью

**Для мониторинга:**

* Windows Диспетчер задач (Ctrl+Shift+Esc)
* Вкладка «Производительность» → раздел «ЦП»
* Найдите процессы «Chloros» или «chloros-backend»

### Использование памяти (RAM)

**Типичное использование:**

* Небольшие проекты (&lt; 100 изображений): 2–4 ГБ
* Средние проекты (100–500 изображений): 4–8 ГБ
* Крупные проекты (500+ изображений): 8–16 ГБ
* Chloros+ в параллельном режиме использует больше оперативной памяти

**Если памяти мало:**

* Обрабатывайте меньшие партии
* Закройте другие приложения
* Увеличьте объем RAM, если регулярно обрабатываете большие наборы данных

### Использование GPU (Chloros+ с CUDA)

Когда включено ускорение GPU:

* GPU NVIDIA показывает высокую загрузку (60-90%)
* Увеличивается использование VRAM (требуется 4 ГБ+ VRAM)
* Этап калибровки значительно ускоряется

**Для мониторинга:**

* Значок NVIDIA в системном трее
* Диспетчер задач → Производительность → GPU
* GPU-Z или аналогичный инструмент мониторинга

### Ввод-вывод диска

**Что ожидать:**

* Высокая скорость чтения с диска на этапе анализа
* Высокая скорость записи на диск на этапе экспорта
* SSD значительно быстрее, чем HDD

**Совет по производительности:**

* По возможности используйте SSD для папки проекта
* Избегайте сетевых дисков для больших наборов данных
* Убедитесь, что диск не заполнен (это влияет на скорость записи)

***

## Обнаружение проблем во время обработки

### Предупреждающие знаки

**Задержка прогресса (без изменений в течение 5+ минут):**

* Проверьте журнал отладки на наличие ошибок
* Проверьте доступное место на диске
* Проверьте диспетчер задач, чтобы убедиться, что Chloros работает

**Часто появляются сообщения об ошибках:**

* Остановите обработку и просмотрите ошибки
* Распространенные причины: место на диске, поврежденные файлы, проблемы с памятью
* См. раздел «Устранение неполадок» ниже

**Система не отвечает:**

* Chloros+ в параллельном режиме использует слишком много ресурсов
* Рассмотрите возможность уменьшения количества одновременных задач или обновления оборудования
* Свободный режим менее ресурсоемкий

### Когда следует остановить обработку

Остановите обработку, если вы видите:

* ❌ Ошибки «Диск заполнен» или «Невозможно записать файл»
* ❌ Повторяющиеся ошибки повреждения файлов изображений
* ❌ Система полностью зависла (не отвечает)
* ❌ Осознали, что были настроены неправильные параметры
* ❌ Импортированы неправильные изображения

**Как остановить:**

1. Нажмите **кнопку «Остановить/Отмена»** (заменяет кнопку «Пуск»)
2. Обработка останавливается, прогресс теряется
3. Исправьте проблемы и начните сначала

***

## Устранение неполадок во время обработки

### Обработка идет очень медленно

**Возможные причины:**

* Неотмеченные целевые изображения (сканирование всех изображений)
* HDD вместо SSD-накопителя
* Недостаточные системные ресурсы
* Настроено много индексов
* Доступ к сетевому диску

**Решения:**

1. Если только что начали и находитесь на этапе обнаружения: отмените, отметьте цели, перезапустите
2. На будущее: используйте SSD, уменьшите количество индексов, обновите оборудование
3. Рассмотрите возможность использования CLI для пакетной обработки больших наборов данных

### Предупреждения о «месте на диске»

**Решения:**

1. Немедленно освободите место на диске
2. Переместите проект на диск с большим количеством места
3. Уменьшите количество индексов для экспорта.
4. Используйте формат JPG вместо TIFF (меньший размер файлов).

### Частые сообщения «Поврежденный файл»

**Решения:**

1. Перекопируйте изображения с SD-карты, чтобы обеспечить их целостность.
2. Проверьте SD-карту на наличие ошибок.
3. Удалите поврежденные файлы из проекта.
4. Продолжите обработку оставшихся изображений.

### Перегрев/ограничение производительности системы

**Решения:**

1. Обеспечьте достаточную вентиляцию.
2. Очистите вентиляционные отверстия компьютера от пыли.
3. Уменьшите нагрузку на процессор (используйте режим Free вместо Chloros+).
4. Выполняйте обработку в более прохладное время суток.

***

## Уведомление о завершении обработки

По завершении обработки:

* Индикатор выполнения достигает 100%
* В журнале отладки появляется сообщение **«Обработка завершена»**
* Кнопка «Пуск» снова становится активной
* Все выходные файлы находятся в подпапке модели камеры

***

## Следующие шаги

После завершения обработки:

1. **Просмотрите результаты** — см. [Завершение обработки](finishing-the-processing.md)
2. **Проверьте папку вывода** — убедитесь, что все файлы экспортированы правильно
3. **Просмотрите журнал отладки** — проверьте, нет ли предупреждений или ошибок
4. **Просмотрите обработанные изображения** — используйте программу просмотра изображений или внешнее программное обеспечение

Информацию о просмотре и использовании обработанных результатов см. в разделе [Завершение обработки](finishing-the-processing.md).
