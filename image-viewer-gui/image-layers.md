# Слои изображения

Выпадающий список «Слои изображения» в программе просмотра изображений Chloros позволяет быстро переключаться между различными версиями одного и того же изображения — от исходных снимков до обработанных результатов отражения и рассчитанных индексных изображений.

## Что такое слои изображения?

В Chloros **слои** относятся к различным вариантам изображения, доступным для одного исходного изображения. При обработке изображений Chloros создает несколько версий:

* **Исходные изображения** (файлы JPG и RAW с вашей камеры)
* **Калиброванные по отражательной способности** результаты (если была включена калибровка отражательной способности)
* **Целевые изображения** (если изображение содержит калибровочные цели)
* **Индексные изображения** (NDVI, NDRE, GNDVI и т. д., если были настроены индексы)

**Выпадающий список выбора слоев** в правом верхнем углу просмотрщика изображений позволяет мгновенно переключаться между этими версиями, не выходя из просмотрщика.

***

## Доступные типы слоев

### JPG

* Исходное изображение JPG из вашей камеры
* Всегда доступно для всех изображений
* Необработанное, как снятое камерой
* Самый быстрый способ загрузки и отображения

**Когда просматривать:**

* Быстрый просмотр исходного снимка
* Проверка композиции и кадрирования изображения
* Проверка качества снимка перед обработкой

### RAW (исходное)

* Оригинальные данные датчика RAW с вашей камеры
* Без постобработки
* Более высокая битовая глубина, чем у JPG (обычно 12-битные или 14-битные данные датчика)

**Когда просматривать:**

* Проверка качества оригинальных данных датчика
* Проверка на наличие проблем с датчиком или артефактов
* Сравнение результатов до и после обработки

### RAW (цель)

* Появляется только для изображений, в которых обнаружены калибровочные мишени
* Показывает исходное изображение RAW с обнаруженной мишенью
* Используется для проверки успешности обнаружения мишени

**Когда просматривать:**

* Подтверждение правильного обнаружения калибровочных мишеней
* Проверка качества изображения мишени
* Устранение неполадок при калибровке

{% hint style=&quot;info&quot; %}
**Слой цели**: этот слой появляется в раскрывающемся списке только для изображений, содержащих калибровочные цели. Обычные снимки не будут иметь эту опцию.
{% endhint %}

### RAW (отражательная способность)

* Калиброванное изображение отражательной способности
* С коррекцией виньетирования (если включено в обработке)
* Отражательная способность откалибрована с использованием данных мишени (если включено)
* Многополосный TIFF со всеми каналами камеры
* Значения пикселей представляют процент отражательной способности (при использовании процентного режима)
* Готов к обработке с помощью [Index/LUT Sandbox](index-lut-sandbox.md)

**Когда просматривать:**

* Проверка откалиброванных результатов
* Проверка качества калибровки
* Проверка значений пикселей на научную точность
* Сравнение с оригиналом для оценки эффектов калибровки

{% hint style=&quot;success&quot; %}
**Рекомендуется**: используйте слой RAW (отражение) при проверке значений пикселей для научных измерений и анализа.
{% endhint %}

### RAW (NDVI индекс)... и подобные

* Рассчитанное изображение индекса растительности (NDVI в этом примере)
* Название индекса меняется в зависимости от того, какой индекс был настроен во время обработки.
* Примеры: RAW (NDVI Index), RAW (NDRE Index), RAW (GNDVI Index) и т. д.
* Однополосное изображение в оттенках серого, показывающее результаты расчета индекса
* Для каждого индекса, настроенного в настройках проекта, отображается один слой

**Возможные названия индексов:**

* RAW (индекс NDVI)
* RAW (индекс NDRE)
* RAW (индекс GNDVI)
* RAW (индекс OSAVI)
* RAW (индекс EVI)
* RAW (индекс SAVI)
* И многие другие... (см. [Формулы мультиспектральных индексов](../project-settings/multispectral-index-formulas.md))

**Когда просматривать:**

* При изучении результатов расчета индекса
* При проверке диапазонов значений индекса
* При определении областей интереса
* При проверке изображений индекса перед использованием в ГИС или анализе

***

## Использование селектора слоев

### Открытие раскрывающегося списка

1. Откройте изображение в полноэкранном режиме (щелкните любую миниатюру в просмотрщике изображений)
2. Найдите **раскрывающийся список слоев** в правом верхнем углу просмотрщика
3. В раскрывающемся списке отображается выбранный в данный момент слой (например, «JPG»)
4. Щелкните раскрывающийся список, чтобы увидеть все доступные слои

### Переключение слоев

1. Щелкните раскрывающийся список слоев, чтобы открыть список
2. Отображаются все доступные слои для текущего изображения
3. Щелкните любое название слоя, чтобы переключиться на эту версию
4. Изображение немедленно обновится, чтобы показать выбранный слой

**Быстрое переключение:**

* Выпадающий список запоминает ваш последний выбор
* При переходе к следующему изображению Chloros пытается показать тот же тип слоя
* Если этот слой не существует на следующем изображении, по умолчанию используется JPG

### Доступность слоев

Не все слои доступны для каждого изображения:

**Всегда доступно:**

* ✅ JPG (каждое изображение имеет предварительный просмотр в формате JPG)

**Доступно при определенных условиях:**

* ⚠️ RAW (оригинал) — только если изображение было снято в режиме RAW или RAW+JPG
* ⚠️ RAW (цель) — только если изображение содержит обнаруженные калибровочные цели
* ⚠️ RAW (отражение) — только после обработки с включенной калибровкой отражения
* ⚠️ RAW (\[Индекс] Индекс) — только после обработки с настроенными индексами

***

## Сохранение слоев

### Переход между изображениями

При переходе к другому изображению (с помощью клавиш со стрелками или щелчка по миниатюрам):

**Настройки слоя сохраняются:**

* При просмотре «RAW (отражение)» следующее изображение отображается в формате «RAW (отражение)» (если доступно)
* При просмотре «RAW (NDVI индекс)» следующее изображение отображается в формате «RAW (NDVI индекс)» (если доступно)
* Если такого слоя нет, по умолчанию используется JPG

**Пример рабочего процесса:**

1. Откройте изображение 1, переключитесь на RAW (NDVI Index)
2. Нажмите →, чтобы просмотреть изображение 2
3. Изображение 2 автоматически отображает слой RAW (NDVI Index)
4. Продолжите навигацию — все изображения отображают слой NDVI.
5. Очень эффективно для просмотра результатов индексации по многим изображениям.

***

## Общие рабочие процессы

### Рабочий процесс 1: сравнение «до» и «после»

**Цель**: сравнить исходное и откалиброванное изображение.

1. Откройте обработанное изображение в Image Viewer.
2. Выберите **RAW (Original)** из раскрывающегося списка.
3. Обратите внимание на виньетирование и некалиброванные значения.
4. Переключитесь на **RAW (отражение)** из раскрывающегося списка.
5. Сравните — виньетирование удалено, значения откалиброваны.

### Рабочий процесс 2: просмотр индекса

**Цель**: быстрый просмотр результатов NDVI по всему набору данных.

1. Откройте первое обработанное изображение.
2. Выберите **RAW (NDVI Index)** из раскрывающегося списка.
3. Используйте клавишу со стрелкой → для перехода к следующему изображению.
4. Слой NDVI сохраняется автоматически.
5. Продолжайте просматривать все изображения, проверяя шаблоны NDVI.
6. Переключитесь на **RAW (NDRE Index)** для сравнения.

### Рабочий процесс 3: Проверка целей

**Цель**: Проверить, что все целевые изображения были обнаружены правильно.

1. Перейдите к целевому изображению.
2. Выберите **RAW (Target)** из раскрывающегося списка.
3. Убедитесь, что калибровочные цели хорошо видны и обнаружены.
4. Перейдите к следующему целевому изображению
5. Повторите проверку для всех целей

### Рабочий процесс 4: Проверка значений пикселей

**Цель**: Проверить значения отражения на научную точность

1. Откройте обработанное изображение
2. Выберите слой **RAW (Отражение)**
3. Включите режим **Процент пикселей** (кнопка в правом верхнем углу панели инструментов)
4. Наведите курсор на участки растительности.
5. Убедитесь, что значения пикселей находятся в ожидаемых диапазонах (30–70 % для NIR, 5–15 % для Red).
6. Проверьте, что значения для участков почвы и воды соответствуют ожидаемым.

***

## Понимание значений пикселей по слоям

Разные слои показывают разные диапазоны значений пикселей:

### Слой JPG

* **Диапазон**: 0-255 (8 бит)
* **Значение**: отображаемые значения, с гамма-коррекцией
* **Использование**: только для визуального осмотра, не для научных измерений

### RAW (исходный)

* **Диапазон**: 0-65535 (16 бит)
* **Значение**: необработанные цифровые данные датчика
* **Использование**: проверка работоспособности датчика, не откалиброванный

### RAW (отражательная способность)

* **Диапазон**: 0–65 535 (16-разрядный TIFF) или 0,0–1,0 (32-разрядный процент)
* **Значение**: калиброванная отражательная способность в процентах
* **Использование**: научные измерения и анализ

**Для 16-разрядного TIFF:** разделите на 65 535, чтобы получить отражательную способность в процентах **Для 32-разрядного Percent:** значения непосредственно представляют проценты (0,5 = 50 % отражательной способности)

### RAW (Индексные изображения)

* **Диапазон**: варьируется в зависимости от индекса (обычно от -1,0 до +1,0 для нормализованных индексов)
* **Значение**: результат расчета индекса
* **Примеры**:
  * NDVI: от -1 до +1 (растительность обычно от 0,4 до 0,9)
  * NDRE: от -1 до +1 (обнаружение стресса)
  * EVI: от 0 до 1 (улучшенная растительность)

***

## Советы и лучшие практики

### Эффективное переключение слоев

* **Знание горячих клавиш**: хотя для слоев нет горячих клавиш, стрелки навигации (←/→) работают во всех слоях
* **Последовательные рабочие процессы**: выберите один слой (например, NDVI) и просмотрите весь набор данных, прежде чем переключаться на другой
* **Быстрое сравнение**: переключайтесь между «Оригинал» и «Отражение», чтобы проверить качество обработки

### Соображения по производительности

* **JPG загружается быстрее всего**: используйте для быстрой навигации по множеству изображений.
* **Слои RAW загружаются медленнее**: более высокое разрешение и битовая глубина.
* **Слои индекса**: скорость аналогична скорости слоев отражения.
* **Первая загрузка происходит медленнее всего**: последующие просмотры того же слоя кэшируются и происходят быстрее.

### Проверка качества

* **Всегда проверяйте RAW (оригинал)**: проверяйте качество исходных данных, прежде чем доверять обработанным результатам
* **Сравнивайте слои**: используйте переключение слоев, чтобы убедиться, что обработка прошла правильно
* **Проверяйте диапазоны индекса**: используйте режим «Процент пикселей» с индексными слоями, чтобы убедиться, что значения являются разумными

***

## Устранение неполадок

### Слой недоступен

**Проблема**: ожидаемый слой не отображается в раскрывающемся списке

**Возможные причины:**

* Изображение не было обработано (доступны только JPG и RAW (оригинал))
* Калибровка отражательной способности была отключена во время обработки
* Конкретный индекс не был настроен в настройках проекта
* Изображение является изображением только цели (индексы для целей не сгенерированы)

**Решения:**

1. Убедитесь, что изображение было обработано (проверьте папку вывода на наличие обработанных файлов).
2. Проверьте настройки проекта, чтобы убедиться, что индексы были настроены.
3. Повторите обработку с включенными нужными индексами.

### Отображается неверный слой

**Проблема**: Изображение открывается в неожиданном слое.

**Причина**: Настройки слоя из предыдущего изображения были перенесены, но этот слой отсутствует в текущем изображении.

**Решение:** Chloros автоматически переключается на JPG, когда предпочтительный слой недоступен — это нормальное поведение.

### Не вижу целевые объекты калибровки

**Проблема:** Слой RAW (целевой) не показывает обнаружение целевых объектов.

**Возможные причины:**

* Цели не были обнаружены во время обработки.
* Изображение фактически не содержит целей.
* Настройки обнаружения целей слишком строгие.

**Решения:**

1. Проверьте журнал отладки на наличие сообщений «Цель найдена».
2. Убедитесь, что изображение действительно содержит видимые калибровочные цели.
3. Настройте параметры обнаружения целей в настройках проекта.
4. См. [Выбор целевых изображений](../processing-images-gui/choosing-target-images.md)

***

## Связанные функции

### Инструменты просмотра изображений

При просмотре любого слоя вы можете использовать:

* **Элементы управления масштабированием**: увеличьте изображение, чтобы рассмотреть детали.
* **Панорамирование**: щелкните и перетащите, чтобы перемещаться по увеличенному изображению.
* **Проверка значения пикселей**: просмотрите значения в месте нахождения курсора.
* **Стрелки навигации**: перемещайтесь между изображениями, сохраняя слой
* **Режим процента пикселей**: переключайтесь между отображением в дискретных значениях и процентах

См. [Открытие изображения в полноэкранном режиме](opening-an-image-full-screen.md) для полной документации по просмотрщику изображений.

### Песочница индекса/LUT

Для интерактивного тестирования и визуализации индекса:

* **Расчет индекса в реальном времени**: тестирование различных формул индекса
* **Цветовое отображение LUT**: применение цветовых градиентов к индексам в оттенках серого
* **Экспорт визуализаций**: сохранение цветных изображений индекса

Подробности см. в разделе [Песочница индекса/LUT](index-lut-sandbox.md).

***

## Следующие шаги

Теперь, когда вы понимаете, что такое слои изображения:

* [**Открытие изображения в полноэкранном режиме**](opening-an-image-full-screen.md) — полное руководство по Image Viewer
* [**Index/LUT Sandbox**](index-lut-sandbox.md) — интерактивная визуализация индекса
* [**Формулы мультиспектрального индекса**](../project-settings/multispectral-index-formulas.md) — справочник доступных индексов
* [**Завершение обработки**](../processing-images-gui/finishing-the-processing.md) — понимание обработанных результатов
